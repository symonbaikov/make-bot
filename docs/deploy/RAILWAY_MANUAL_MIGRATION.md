# üîß –†—É—á–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –≤ Railway

## –ü—Ä–æ–±–ª–µ–º–∞

–ú–∏–≥—Ä–∞—Ü–∏–∏ Prisma –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –¥–µ–ø–ª–æ–µ. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç–∞—è, —Ç–∞–±–ª–∏—Ü—ã –Ω–µ —Å–æ–∑–¥–∞–Ω—ã.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—Ä—É—á–Ω—É—é

### –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ Railway CLI (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Railway CLI:**
   ```bash
   npm i -g @railway/cli
   ```

2. **–í–æ–π–¥–∏—Ç–µ –≤ Railway:**
   ```bash
   railway login
   ```

3. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –ø—Ä–æ–µ–∫—Ç—É:**
   ```bash
   cd /path/to/make-bot
   railway link
   ```
   –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç –∏ —Å–µ—Ä–≤–∏—Å `@make-bot/backend`

4. **–ü–æ–ª—É—á–∏—Ç–µ DATABASE_URL:**
   ```bash
   railway variables
   ```
   –ù–∞–π–¥–∏—Ç–µ `DATABASE_URL` –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–µ

5. **–ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏:**
   ```bash
   cd backend
   export DATABASE_URL="postgresql://..." # –í—Å—Ç–∞–≤—å—Ç–µ DATABASE_URL –∏–∑ Railway
   npx prisma db push
   ```

6. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ seed (—Å–æ–∑–¥–∞—Å—Ç –∞–¥–º–∏–Ω–∞):**
   ```bash
   npm run db:seed
   ```

### –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ Railway Web Interface (Query)

1. **–û—Ç–∫—Ä–æ–π—Ç–µ PostgreSQL —Å–µ—Ä–≤–∏—Å** –≤ Railway
2. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Database ‚Üí Query**
3. **–í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –∫–æ–º–∞–Ω–¥—ã –≤—Ä—É—á–Ω—É—é:**

   –°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—ã —á–µ—Ä–µ–∑ Prisma schema. –ù–æ –ø—Ä–æ—â–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ø–æ—Å–æ–± 1 –∏–ª–∏ 3.

### –°–ø–æ—Å–æ–± 3: –ß–µ—Ä–µ–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–µ—Å–ª–∏ CLI –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)

1. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ Railway —á–µ—Ä–µ–∑ SSH:**
   ```bash
   railway shell
   ```

2. **–ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π:**
   - –í Railway —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ—Ç –∂–µ Dockerfile
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `DATABASE_URL` –∏–∑ PostgreSQL —Å–µ—Ä–≤–∏—Å–∞
   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:
     ```bash
     cd backend && npx prisma db push && npm run db:seed
     ```

### –°–ø–æ—Å–æ–± 4: –ß–µ—Ä–µ–∑ –ª–æ–∫–∞–ª—å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

1. **–ü–æ–ª—É—á–∏—Ç–µ DATABASE_URL –∏–∑ Railway:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ PostgreSQL —Å–µ—Ä–≤–∏—Å ‚Üí Variables
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `DATABASE_URL`

2. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –ª–æ–∫–∞–ª—å–Ω–æ:**
   ```bash
   cd backend
   export DATABASE_URL="postgresql://..." # –í—Å—Ç–∞–≤—å—Ç–µ DATABASE_URL
   npx prisma db push
   npm run db:seed
   ```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–±–ª–∏—Ü—ã –≤ Railway:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ PostgreSQL ‚Üí Database ‚Üí Data
   - –î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ç–∞–±–ª–∏—Ü—ã: `web_users`, `users`, `sessions`, `actions`

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–¥–º–∏–Ω–∞:**
   - –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–ª–æ–≥–∏–Ω–∏—Ç—å—Å—è: `admin@example.com` / `admin123`

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Backend:**
   - –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–æ–∫ –ø—Ä–æ `web_users does not exist`

## –ü–æ—á–µ–º—É –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏?

–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:

1. **docker-entrypoint.sh –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Deploy Logs –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π `Starting backend service...`
   - –ï—Å–ª–∏ –∏—Ö –Ω–µ—Ç, –∑–Ω–∞—á–∏—Ç `ENTRYPOINT` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

2. **–û—à–∏–±–∫–∏ –≤ docker-entrypoint.sh:**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏ –º–∏–≥—Ä–∞—Ü–∏–π
   - –í–æ–∑–º–æ–∂–Ω–æ, `prisma db push` –ø–∞–¥–∞–µ—Ç —Å –æ—à–∏–±–∫–æ–π

3. **DATABASE_URL –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Variables Backend —Å–µ—Ä–≤–∏—Å–∞
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `DATABASE_URL` —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –∏–∑ PostgreSQL —Å–µ—Ä–≤–∏—Å–∞

4. **Prisma schema –Ω–µ –Ω–∞–π–¥–µ–Ω:**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `prisma/schema.prisma` –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤ Docker –æ–±—Ä–∞–∑

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –±—É–¥—É—â–∏—Ö –¥–µ–ø–ª–æ–µ–≤

–ü–æ—Å–ª–µ —Ä—É—á–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:

1. ‚úÖ `railway.json` –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç `startCommand` (—á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è ENTRYPOINT)
2. ‚úÖ `DATABASE_URL` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ Variables Backend —Å–µ—Ä–≤–∏—Å–∞
3. ‚úÖ `docker-entrypoint.sh` –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (`chmod +x`)
4. ‚úÖ Prisma schema –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤ Docker –æ–±—Ä–∞–∑

## Troubleshooting

### –û—à–∏–±–∫–∞: "prisma: command not found"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
npm install -g prisma
# –∏–ª–∏
npx prisma db push
```

### –û—à–∏–±–∫–∞: "DATABASE_URL is not set"

**–†–µ—à–µ–Ω–∏–µ:**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `DATABASE_URL` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ Railway Variables
- –ò–ª–∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ: `export DATABASE_URL="..."`

### –û—à–∏–±–∫–∞: "relation already exists"

**–†–µ—à–µ–Ω–∏–µ:**
- –¢–∞–±–ª–∏—Ü—ã —É–∂–µ —Å–æ–∑–¥–∞–Ω—ã, —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ
- –ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ seed: `npm run db:seed`

