# üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞: –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—ã

## –ü—Ä–æ–±–ª–µ–º–∞

–ö–æ–º–∞–Ω–¥—ã –ø–æ–ø–∞–¥–∞—é—Ç –≤ –±–æ—Ç (–≤–∏–¥–Ω–æ –≤ –ª–æ–≥–∞—Ö), –Ω–æ –±–æ—Ç –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç—ã.

## –ß—Ç–æ —è –¥–æ–±–∞–≤–∏–ª

### 1. –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∫–∞–∂–¥–æ–≥–æ update
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ –¢–∞–π–º–∞—É—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ update (10 —Å–µ–∫—É–Ω–¥)

### 2. –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- ‚úÖ –ü–æ–ø—ã—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ—à–∏–±–æ–∫

## –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ Railway

–û—Ç–∫—Ä–æ–π—Ç–µ **Bot —Å–µ—Ä–≤–∏—Å** ‚Üí **Deploy Logs** –∏ –Ω–∞–π–¥–∏—Ç–µ:

**–ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã `/start`:**

```
üì• Webhook request received { updateId: ..., message: '/start', ... }
üîÑ Processing update { updateType: 'message', command: 'start', ... }
Start command received { userId: ..., ... }
Session initialized for data collection { ... }
Sending welcome message { userId: ..., chatId: ..., ... }
‚úÖ Welcome message sent successfully { messageId: ..., ... }
‚úÖ Webhook processed successfully { ... }
```

**–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫—É:**

```
‚ùå Failed to send welcome message { error: ..., ... }
```

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ webhook —Å—Ç–∞—Ç—É—Å

–û—Ç–∫—Ä–æ–π—Ç–µ:

```
https://make-botbot-production.up.railway.app/webhook-test
```

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**

```json
{
  "status": "ok",
  "webhook": {
    "url": "https://make-botbot-production.up.railway.app/webhook",
    "pendingUpdates": 0,
    "lastError": "",
    "lastErrorDate": 0
  }
}
```

**–ï—Å–ª–∏ `url: ""`:**

- Webhook –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –±–æ—Ç–∞ - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
  ```
  ‚úÖ Webhook set successfully!
  ```

**–ï—Å–ª–∏ `lastError` –Ω–µ –ø—É—Å—Ç–æ–π:**

- Telegram –Ω–µ –º–æ–∂–µ—Ç –¥–æ—Å—Ç–∞–≤–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å URL

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ HTTP Logs

–í Railway –æ—Ç–∫—Ä–æ–π—Ç–µ **Bot —Å–µ—Ä–≤–∏—Å** ‚Üí **HTTP Logs** –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ `/start` –±–æ—Ç—É.

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**

```
POST /webhook 200
```

**–ï—Å–ª–∏ –Ω–µ—Ç –∑–∞–ø—Ä–æ—Å–æ–≤:**

- Telegram –Ω–µ –¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ webhook —á–µ—Ä–µ–∑ Telegram API

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á–µ—Ä–µ–∑ Telegram API

–í—ã–ø–æ–ª–Ω–∏—Ç–µ (–∑–∞–º–µ–Ω–∏—Ç–µ `YOUR_BOT_TOKEN`):

```bash
curl "https://api.telegram.org/bot<YOUR_BOT_TOKEN>/getWebhookInfo"
```

**–î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å:**

```json
{
  "ok": true,
  "result": {
    "url": "https://make-botbot-production.up.railway.app/webhook",
    "pending_update_count": 0,
    "last_error_date": 0,
    "last_error_message": ""
  }
}
```

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã

### 1. Webhook –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (`url: ""`)

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `‚úÖ Webhook set successfully!`

### 2. –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `‚ùå Failed to send welcome message`

### 3. –¢–∞–π–º–∞—É—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `Update handling timeout after 10s`

### 4. –û—à–∏–±–∫–∞ –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `‚ùå Unhandled bot error`

## –ß—Ç–æ –¥–µ–ª–∞—Ç—å —Å–µ–π—á–∞—Å

1. **–ó–∞–¥–µ–ø–ª–æ–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è** (–æ–Ω–∏ —É–∂–µ –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã)
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏** –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ `/start` –±–æ—Ç—É
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ webhook —Å—Ç–∞—Ç—É—Å** —á–µ—Ä–µ–∑ `/webhook-test`
4. **–û—Ç–ø—Ä–∞–≤—å—Ç–µ –º–Ω–µ –ª–æ–≥–∏**, –µ—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–µ–Ω–∞

## –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ `/start`:

1. ‚úÖ Webhook –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–ø—Ä–æ—Å
2. ‚úÖ Update –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è
3. ‚úÖ Start handler –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
4. ‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
5. ‚úÖ –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —É—Å–ø–µ—à–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É

–ï—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —à–∞–≥ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –¥–ª—è —ç—Ç–æ–≥–æ —à–∞–≥–∞.
