# Bot Tests

## Запуск тестов

```bash
# Установить зависимости (если еще не установлены)
npm install

# Запустить все тесты
npm test

# Запустить тесты в watch режиме
npm run test:watch

# Запустить тесты с покрытием кода
npm run test:coverage
```

## Структура тестов

- `start-handler.test.ts` - Тесты для команды /start
- `plan-handler.test.ts` - Тесты для выбора тарифа
- `bot-integration.test.ts` - Интеграционные тесты полного потока
- `bot-handlers.test.ts` - Тесты проверки регистрации обработчиков

## Что тестируется

1. **Команда /start:**
   - Инициализация сессии
   - Отправка приветственного сообщения
   - Отображение кнопок с тарифами
   - Обработка ошибок

2. **Выбор тарифа:**
   - Обработка всех трех тарифов (BASIC, STANDARD, PREMIUM)
   - Сохранение тарифа и цены в сессии
   - Переход к запросу email
   - Валидация неверных данных

3. **Интеграционный поток:**
   - Полный цикл: start -> plan -> email
   - Правильность изменения состояний сессии
   - Корректность передачи данных между обработчиками

4. **Регистрация обработчиков:**
   - Все функции экспортируются
   - Кнопки имеют правильные callback_data
   - Украинские названия тарифов

## Запуск перед коммитом

Рекомендуется запускать тесты перед каждым коммитом:

```bash
npm test
```

Это поможет предотвратить поломку функциональности при изменениях кода.

