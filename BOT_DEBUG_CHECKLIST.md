# üîç –ß–µ–∫–ª–∏—Å—Ç –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –±–æ—Ç–∞

## –ü—Ä–æ–±–ª–µ–º–∞: –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—É /start

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ webhook URL

–í Railway –¥–ª—è **Bot —Å–µ—Ä–≤–∏—Å–∞** (`@make-bot/bot`):

1. –û—Ç–∫—Ä–æ–π—Ç–µ **Variables**
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `TELEGRAM_WEBHOOK_URL`:
   - –î–æ–ª–∂–µ–Ω –±—ã—Ç—å: `https://make-botbot-production.up.railway.app/webhook`
   - –ù–ï –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å: `https://make-botbot-production.up.railway.app/` (–±–µ–∑ `/webhook`)

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞

–í Railway –æ—Ç–∫—Ä–æ–π—Ç–µ **Bot —Å–µ—Ä–≤–∏—Å** ‚Üí **Logs** –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```
Starting bot in webhook mode: https://make-botbot-production.up.railway.app/webhook
Webhook server listening on port 8080
Webhook set to: https://make-botbot-production.up.railway.app/webhook
```

**–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫–∏:**
- `Failed to set webhook` - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ URL
- `Error handling webhook update` - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É –∫–æ–º–∞–Ω–¥
- –ù–µ—Ç –ª–æ–≥–æ–≤ –≤–æ–æ–±—â–µ - –±–æ—Ç –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª—Å—è

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å webhook

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
https://make-botbot-production.up.railway.app/health
```

–î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å:
```json
{"status":"ok","mode":"webhook"}
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:
- `TELEGRAM_BOT_TOKEN` - —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
- `TELEGRAM_WEBHOOK_URL` - –ø–æ–ª–Ω—ã–π URL —Å `/webhook`
- `API_URL` - URL –±—ç–∫–µ–Ω–¥–∞
- `NODE_ENV=production` - –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É –∫–æ–º–∞–Ω–¥—ã /start

–ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ `/start` –≤ –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
Start command received { userId: ..., username: ..., messageText: '/start' }
Start command { sessionId: 'none', userId: ... }
```

–ï—Å–ª–∏ —ç—Ç–∏—Ö –ª–æ–≥–æ–≤ –Ω–µ—Ç - –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –¥–æ—Ö–æ–¥–∏—Ç –¥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞.

### –®–∞–≥ 6: –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ polling

–ï—Å–ª–∏ webhook –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –º–æ–∂–Ω–æ –≤—Ä–µ–º–µ–Ω–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å polling:

1. –í Railway –¥–ª—è Bot —Å–µ—Ä–≤–∏—Å–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
   ```
   ALLOW_POLLING_IN_PRODUCTION=true
   ```

2. –£–¥–∞–ª–∏—Ç–µ –∏–ª–∏ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ `TELEGRAM_WEBHOOK_URL`

3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç

**–í–Ω–∏–º–∞–Ω–∏–µ:** Polling –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è!

### –®–∞–≥ 7: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω

–í Railway –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
- –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å "Running"
- –ü–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–ø–ª–æ–π –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å–ø–µ—à–Ω—ã–º
- –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

## –ë—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

–í—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç–∏ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ health endpoint
curl https://make-botbot-production.up.railway.app/health

# –ü—Ä–æ–≤–µ—Ä–∫–∞ webhook endpoint (–¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—à–∏–±–∫—É, —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ)
curl -X POST https://make-botbot-production.up.railway.app/webhook
```

## –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **Webhook URL –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π** - –¥–æ–ª–∂–µ–Ω –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å—Å—è –Ω–∞ `/webhook`
2. **–ë–æ—Ç –Ω–µ –∑–∞–ø—É—â–µ–Ω** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –≤ Railway
3. **–û—à–∏–±–∫–∏ –≤ –∫–æ–¥–µ** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
4. **Telegram –Ω–µ –º–æ–∂–µ—Ç –¥–æ—Å—Ç—É—á–∞—Ç—å—Å—è** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –¥–æ–º–µ–Ω–∞

